{% extends "base.html" %}
{% import "macros.html" as m %}

{% block content %}

{# ── Page Header ──────────────────────────────────────── #}
<div class="overview-spacer"></div>

{# ── Features ─────────────────────────────────────────── #}
<section id="features" class="features section">
  <div class="container">
    <div class="section-header">
      <h2>Built for how you actually watch</h2>
      <p>Local files, streaming, or both. Ryuuji doesn't care &mdash; it just keeps up.</p>
    </div>

    <div class="grid-2">
      {{ m::feature_card(
        title="Automatic detection",
        description="Supports 20+ media players on Linux and Windows, plus streaming services like Crunchyroll, Netflix, and Jellyfin in your browser. All player definitions live in a config file &mdash; adding new ones doesn't require touching the code.",
        icon='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>'
      ) }}

      {{ m::feature_card(
        title="Smart recognition",
        description="Correctly identifies anime even from messy fansub filenames like <code>[SubGroup] Title - 05v2 (BD 1080p) [ABCD1234].mkv</code>. Fuzzy matching means minor naming differences won't trip it up.",
        icon='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>'
      ) }}

      {{ m::feature_card(
        title="Multi-service sync",
        description="Connect MyAnimeList, AniList, or Kitsu and your progress syncs automatically after each episode. Import your existing list from any of them to get started instantly.",
        icon='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>'
      ) }}

      {{ m::feature_card(
        title="Local-first storage",
        description="Your library and watch history live in a local database on your machine. Works fully offline &mdash; tracking services are optional, not required.",
        icon='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M3 5V19A9 3 0 0 0 21 19V5"/><path d="M3 12A9 3 0 0 0 21 12"/></svg>'
      ) }}
    </div>
  </div>
</section>

{# ── How It Works ─────────────────────────────────────── #}
<section id="how-it-works" class="how-it-works section">
  <div class="container">
    <div class="section-header">
      <h2>How it works</h2>
      <p>Three things happen in the background every few seconds while you watch.</p>
    </div>

    <div class="steps">
      {{ m::step(
        number="1",
        title="Detect",
        description="Ryuuji scans for running media players on your system. If you're watching in a browser, it checks the active tab against known streaming services like Crunchyroll, Netflix, or Jellyfin."
      ) }}

      <div class="step-connector"></div>

      {{ m::step(
        number="2",
        title="Recognize",
        description="The anime title and episode number are extracted from the filename or browser tab. Even heavily tagged fansub releases are parsed correctly. The title is then matched against your library using fuzzy search, so small naming differences are handled automatically."
      ) }}

      <div class="step-connector"></div>

      {{ m::step(
        number="3",
        title="Update & Sync",
        description="Your episode progress is updated locally and logged to your watch history. If you've connected a tracking service, the update is pushed there too. Multi-season shows with continuous numbering are remapped automatically."
      ) }}
    </div>
  </div>
</section>

{# ── Supported ────────────────────────────────────────── #}
<section id="supported" class="supported section">
  <div class="container">
    <div class="section-header">
      <h2>Works with what you already use</h2>
      <p>Players, streaming services, tracking sites, and browsers &mdash; no switching required.</p>
    </div>

    <div class="supported-group">
      <h3>Media Players</h3>
      <div class="logo-grid">
        {{ m::service_item(name="mpv", color="102, 51, 153") }}
        {{ m::service_item(name="VLC", color="255, 136, 0") }}
        {{ m::service_item(name="MPC-HC") }}
        {{ m::service_item(name="MPC-BE") }}
        {{ m::service_item(name="PotPlayer") }}
        {{ m::service_item(name="Kodi", color="18, 142, 212") }}
        {{ m::service_item(name="Celluloid") }}
        {{ m::service_item(name="SMPlayer") }}
        {{ m::service_item(name="Haruna") }}
        {{ m::service_item(name="KMPlayer") }}
        {{ m::service_item(name="GOM Player") }}
        {{ m::service_item(name="QMPlay2") }}
      </div>
    </div>

    <div class="supported-group">
      <h3>Streaming Services</h3>
      <div class="logo-grid">
        {{ m::service_item(name="Crunchyroll", color="244, 117, 33") }}
        {{ m::service_item(name="Netflix", icon="netflix.svg", color="229, 9, 20") }}
        {{ m::service_item(name="Jellyfin", color="0, 164, 217") }}
        {{ m::service_item(name="Plex", color="233, 160, 13") }}
        {{ m::service_item(name="Hidive", color="0, 174, 239") }}
        {{ m::service_item(name="Bilibili", color="0, 161, 214") }}
      </div>
    </div>

    <div class="supported-group">
      <h3>Tracking Services</h3>
      <div class="logo-grid">
        {{ m::service_item(name="MyAnimeList", color="46, 81, 162") }}
        {{ m::service_item(name="AniList", color="61, 180, 242") }}
        {{ m::service_item(name="Kitsu", color="239, 83, 63") }}
      </div>
    </div>

    <div class="supported-group">
      <h3>Browsers</h3>
      <div class="logo-grid">
        {{ m::service_item(name="Firefox", icon="firefox.svg", color="255, 113, 63") }}
        {{ m::service_item(name="Chrome", icon="chrome.svg", color="66, 133, 244") }}
        {{ m::service_item(name="Edge", icon="edge.svg", color="0, 120, 215") }}
        {{ m::service_item(name="Brave", icon="brave.svg", color="251, 84, 43") }}
      </div>
    </div>
  </div>
</section>

{# ── Screenshots ──────────────────────────────────────── #}
{% if config.extra.show_screenshots %}
<section id="screens" class="screenshot-section section">
  <div class="container">
    <div class="section-header">
      <h2>What it looks like</h2>
      <p>A focused desktop interface for managing everything in one place.</p>
    </div>

    <div class="grid-3">
      <div class="screen-card">
        <div class="screen-preview">Now Playing</div>
        <h3>Now Playing</h3>
        <p>See what's being detected right now &mdash; the anime, episode, and which player is running.</p>
      </div>
      <div class="screen-card">
        <div class="screen-preview">Library</div>
        <h3>Library</h3>
        <p>Browse and manage your full anime list with status filters: watching, completed, planned, and more.</p>
      </div>
      <div class="screen-card">
        <div class="screen-preview">History</div>
        <h3>History</h3>
        <p>A timestamped log of everything you've watched, so you never lose track.</p>
      </div>
      <div class="screen-card">
        <div class="screen-preview">Search</div>
        <h3>Search</h3>
        <p>Find anime across your local library and online services in one search.</p>
      </div>
      <div class="screen-card">
        <div class="screen-preview">Season Charts</div>
        <h3>Season Charts</h3>
        <p>Browse current and upcoming anime seasons without leaving the app.</p>
      </div>
      <div class="screen-card">
        <div class="screen-preview">Torrents</div>
        <h3>Torrents</h3>
        <p>Monitor RSS feeds and filter new episodes with the built-in torrent manager.</p>
      </div>
    </div>
  </div>
</section>
{% endif %}

{# ── Roadmap ──────────────────────────────────────────── #}
<section id="roadmap" class="roadmap section">
  <div class="container">
    <div class="section-header">
      <h2>Roadmap</h2>
      <p>What's shipped, what's next.</p>
    </div>

    <div class="roadmap-list">
      <div class="roadmap-item done">
        <div class="roadmap-status">Done</div>
        <div class="roadmap-content">
          <h3>Multi-service v1</h3>
          <p>Full support for MAL, AniList, and Kitsu with bidirectional sync.</p>
        </div>
      </div>

      <div class="roadmap-item current">
        <div class="roadmap-status">In Progress</div>
        <div class="roadmap-content">
          <h3>Tauri Parallel App</h3>
          <p>Migrating to a modern web-based frontend using Tauri and Leptos for better cross-platform consistency.</p>
        </div>
      </div>

      <div class="roadmap-item">
        <div class="roadmap-status">Planned</div>
        <div class="roadmap-content">
          <h3>
            <img src="/icons/discord.svg" width="20" height="20" alt="" style="vertical-align: bottom; margin-right: 6px;">
            Discord Rich Presence
          </h3>
          <p>Show your current anime progress to your friends on Discord automatically.</p>
        </div>
      </div>

      <div class="roadmap-item">
        <div class="roadmap-status">Planned</div>
        <div class="roadmap-content">
          <h3>Desktop Notifications</h3>
          <p>Native OS notifications for detection events and sync status.</p>
        </div>
      </div>
    </div>
  </div>
</section>

{# ── Download ─────────────────────────────────────────── #}
<section id="download" class="download section">
  <div class="container">
    <div class="download-card">
      <div class="section-header">
        <h2>Get Ryuuji</h2>
        <p>Install the app, connect a tracking service, and just watch &mdash; Ryuuji handles the rest.</p>
      </div>

      <div class="download-platforms">
        <div class="platform-item">
          <a href="{{ config.extra.github_url }}/releases/latest" class="btn btn-primary btn-lg">
            <img src="/icons/linux.svg" width="24" height="24" alt="Linux" style="margin-right: 12px;">
            Download for Linux
          </a>
          <span class="platform-info">.AppImage, .deb, .rpm</span>
        </div>
        <div class="platform-item">
          <a href="{{ config.extra.github_url }}/releases/latest" class="btn btn-primary btn-lg">
            <img src="/icons/windows.svg" width="24" height="24" alt="Windows" style="margin-right: 12px;">
            Download for Windows
          </a>
          <span class="platform-info">.exe installer, portable</span>
        </div>
      </div>

      <div class="alert alert-info" style="max-width: 600px; margin-inline: auto; text-align: left;">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
        <div>
          <strong>Linux Users:</strong> Ensure you have <code>libdbus-1-dev</code> installed for MPRIS player detection to work correctly.
        </div>
      </div>

      <div class="download-source">
        <p>Or build from source:</p>
        <div class="code-block"><span class="prompt">$ </span><span class="cmd">cargo install --git {{ config.extra.github_url }} ryuuji-gui</span></div>
      </div>
    </div>
  </div>
</section>

{% endblock content %}
