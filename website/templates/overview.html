{% extends "base.html" %}
{% import "macros.html" as m %}

{% block content %}

{# ── Page Header ──────────────────────────────────────── #}
<div class="overview-spacer"></div>

{# ── Features ─────────────────────────────────────────── #}
<section id="features" class="features section">
  <div class="container">
    <div class="section-header">
      <h2>Everything you need, nothing you don't</h2>
      <p>Local files, streaming, or both. Ryuuji doesn't care &mdash; it just keeps up.</p>
    </div>

    <div class="grid-2">
      {{ m::feature_card(
        title="Finds your player automatically",
        description="mpv, VLC, MPC-HC, Kodi, PotPlayer &mdash; 20+ players on Linux and Windows, plus streaming services like Crunchyroll and Netflix in your browser. Player definitions live in a config file, so adding new ones is just a few lines of TOML.",
        icon='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>'
      ) }}

      {{ m::feature_card(
        title="Handles even the messiest filenames",
        description="Got files named <code>[SubGroup] Title - 05v2 (BD 1080p) [ABCD1234].mkv</code>? No problem. The parser strips tags, version numbers, and resolution markers, then fuzzy-matches against your library so small naming differences never trip it up.",
        icon='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>'
      ) }}

      {{ m::feature_card(
        title="Syncs to your tracking service",
        description="Connect MyAnimeList, AniList, or Kitsu and your progress syncs automatically after each episode. Already have a list somewhere? Import it in one click and pick up right where you left off.",
        icon='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>'
      ) }}

      {{ m::feature_card(
        title="Your data stays on your machine",
        description="Your library and watch history live in a local database. No account required, no cloud dependency. Tracking services are there if you want them &mdash; not because you need them.",
        icon='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M3 5V19A9 3 0 0 0 21 19V5"/><path d="M3 12A9 3 0 0 0 21 12"/></svg>'
      ) }}
    </div>
  </div>
</section>

{# ── How It Works ─────────────────────────────────────── #}
<section id="how-it-works" class="how-it-works section">
  <div class="container">
    <div class="section-header">
      <h2>How it works</h2>
      <p>Three things happen in the background every few seconds while you watch.</p>
    </div>

    <div class="pipeline">
      {{ m::pipeline_step(
        number="1",
        icon=m::icon_eye(),
        title="Detect",
        subtitle="Finds your player",
        description="Ryuuji scans for running media players on your system &mdash; mpv, VLC, Kodi, you name it. Watching in a browser? It picks up Crunchyroll, Netflix, Jellyfin, and more from the active tab. No extensions needed."
      ) }}

      <div class="pipeline-arrow" aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
      </div>

      {{ m::pipeline_step(
        number="2",
        icon=m::icon_sparkles(),
        title="Recognize",
        subtitle="Parses the filename or browser tab",
        description="The anime title and episode number are extracted from even the messiest fansub names. Fuzzy matching handles minor differences automatically, and an embedded relations database remaps multi-season numbering."
      ) }}

      <div class="pipeline-arrow" aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
      </div>

      {{ m::pipeline_step(
        number="3",
        icon=m::icon_cloud_upload(),
        title="Update & Sync",
        subtitle="Saves and syncs your progress",
        description="Your episode progress is saved locally and logged in your watch history. Connected to MAL, AniList, or Kitsu? The update gets pushed there too &mdash; automatically, in the background."
      ) }}
    </div>
  </div>
</section>

{# ── Supported ────────────────────────────────────────── #}
<section id="supported" class="supported section">
  <div class="container">
    <div class="section-header">
      <h2>Works with what you already use</h2>
      <p>No extensions, no plugins.</p>
    </div>

    <div class="supported-compact">
      <div class="supported-row">
        <span class="supported-label">Players</span>
        <div class="supported-tags">
          {{ m::service_item(name="mpv", color="102, 51, 153") }}
          {{ m::service_item(name="VLC", color="255, 136, 0") }}
          {{ m::service_item(name="MPC-HC") }}
          {{ m::service_item(name="MPC-BE") }}
          {{ m::service_item(name="PotPlayer") }}
          {{ m::service_item(name="Kodi", color="18, 142, 212") }}
          {{ m::service_item(name="Celluloid") }}
          {{ m::service_item(name="SMPlayer") }}
          {{ m::service_item(name="Haruna") }}
          {{ m::service_item(name="KMPlayer") }}
          {{ m::service_item(name="GOM Player") }}
          {{ m::service_item(name="QMPlay2") }}
          {{ m::service_item(name="GNOME Videos") }}
          {{ m::service_item(name="Clapper") }}
          {{ m::service_item(name="Dragon Player") }}
          {{ m::service_item(name="Parole") }}
          {{ m::service_item(name="Baka MPlayer") }}
          {{ m::service_item(name="Elisa") }}
          {{ m::service_item(name="Windows Media Player") }}
          {{ m::service_item(name="WMP (New)") }}
        </div>
      </div>

      <div class="supported-row">
        <span class="supported-label">Streaming</span>
        <div class="supported-tags">
          {{ m::service_item(name="Crunchyroll", color="244, 117, 33") }}
          {{ m::service_item(name="Netflix", icon="netflix.svg", color="229, 9, 20") }}
          {{ m::service_item(name="Jellyfin", color="0, 164, 217") }}
          {{ m::service_item(name="Plex", color="233, 160, 13") }}
          {{ m::service_item(name="Hidive", color="0, 174, 239") }}
          {{ m::service_item(name="Bilibili", color="0, 161, 214") }}
        </div>
      </div>

      <div class="supported-row">
        <span class="supported-label">Trackers</span>
        <div class="supported-tags">
          {{ m::service_item(name="MyAnimeList", color="46, 81, 162") }}
          {{ m::service_item(name="AniList", color="61, 180, 242") }}
          {{ m::service_item(name="Kitsu", color="239, 83, 63") }}
        </div>
      </div>

      <div class="supported-row">
        <span class="supported-label">Browsers</span>
        <div class="supported-tags">
          {{ m::service_item(name="Firefox", icon="firefox.svg", color="255, 113, 63") }}
          {{ m::service_item(name="Chrome", icon="chrome.svg", color="66, 133, 244") }}
          {{ m::service_item(name="Edge", icon="edge.svg", color="0, 120, 215") }}
          {{ m::service_item(name="Brave", icon="brave.svg", color="251, 84, 43") }}
        </div>
      </div>
    </div>
  </div>
</section>

{# ── FAQ ──────────────────────────────────────────────── #}
<section id="faq" class="faq section">
  <div class="container">
    <div class="section-header">
      <h2>Frequently asked questions</h2>
    </div>

    <div class="faq-list">
      {{ m::faq_item(
        question="Does Ryuuji need to be running all the time?",
        answer="Yes &mdash; Ryuuji runs quietly in the background and scans for active media players every few seconds. If nothing is playing, it idles with minimal resource usage."
      ) }}

      {{ m::faq_item(
        question="Will it detect anime I'm streaming?",
        answer="Yes. Ryuuji supports Crunchyroll, Netflix, Jellyfin, Plex, Hidive, and Bilibili in Firefox, Chrome, Edge, and Brave. No browser extension required &mdash; it reads the active tab title directly."
      ) }}

      {{ m::faq_item(
        question="Can I use it without MAL, AniList, or Kitsu?",
        answer="Absolutely. Ryuuji works fully offline with its local database. Your library, watch history, and progress are all stored on your machine. Tracking services are optional &mdash; connect them if you want cloud sync, skip them if you don't."
      ) }}

      {{ m::faq_item(
        question="How does it handle weird episode numbering?",
        answer="Ryuuji includes an embedded anime-relations database that maps continuous episode numbers to per-season numbering. So if your file says episode 26 but it's actually season 2 episode 1, Ryuuji figures that out automatically."
      ) }}

      {{ m::faq_item(
        question="My media player isn't listed. Can I add it?",
        answer="Yes. Add a new entry to <code>~/.config/ryuuji/players.toml</code> with the player's executable name, window class, and a title regex. No code changes needed &mdash; Ryuuji picks it up on the next scan."
      ) }}

      {{ m::faq_item(
        question="Is macOS supported?",
        answer="Not yet. Ryuuji currently supports Linux and Windows. macOS support depends on finding a reliable way to detect active media players on that platform."
      ) }}
    </div>
  </div>
</section>

{# ── Download ─────────────────────────────────────────── #}
<section id="download" class="download section">
  <div class="container">
    <div class="download-card">
      <div class="section-header">
        <h2>Ready to try it?</h2>
        <p>Download, connect your tracking service, and start watching. Setup takes under a minute.</p>
      </div>

      <div class="download-platforms">
        <div class="platform-item">
          <a href="{{ config.extra.github_url }}/releases/latest" class="btn btn-primary btn-lg">
            {{ m::icon_linux_tux() }}
            Download for Linux
          </a>
          <span class="platform-info">.AppImage, .deb, .rpm</span>
          <span class="platform-note">Requires <code>libdbus-1-dev</code> for MPRIS detection</span>
        </div>
        <div class="platform-item">
          <a href="{{ config.extra.github_url }}/releases/latest" class="btn btn-primary btn-lg">
            {{ m::icon_windows_dl() }}
            Download for Windows
          </a>
          <span class="platform-info">.exe installer, portable</span>
        </div>
      </div>

      <div class="download-features">
        <p class="download-features-label">What's included</p>
        <ul>
          <li>Automatic player detection</li>
          <li>Local anime library</li>
          <li>MAL, AniList &amp; Kitsu sync</li>
          <li>Season browser</li>
          <li>Torrent RSS monitor</li>
        </ul>
      </div>

      <div class="download-source">
        <p>Or build from source:</p>
        <div class="code-block"><span class="prompt">$ </span><span class="cmd">cargo install --git {{ config.extra.github_url }} ryuuji-gui</span></div>
      </div>
    </div>
  </div>
</section>

{% endblock content %}
