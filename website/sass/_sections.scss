// Section-specific styles

// ── View Transitions (cross-document MPA) ────────────────────────
@view-transition {
  navigation: auto;
}

::view-transition-old(root) {
  animation: 150ms ease-out both fade-out;
}

::view-transition-new(root) {
  animation: 200ms ease-out 100ms both fade-in;
}

// Navbar persists across navigations — no fade, no snapshot flicker
::view-transition-old(site-nav),
::view-transition-new(site-nav) {
  animation: none;
}

@keyframes fade-out {
  to { opacity: 0; }
}

@keyframes fade-in {
  from { opacity: 0; }
}

// ── Scroll-triggered entrance animations ──────────────────────
// Elements start invisible and slide up; IntersectionObserver
// adds .is-visible to trigger the transition (one-shot).
[data-animate] {
  opacity: 0;
  transform: translateY(12px);
  transition: opacity 800ms cubic-bezier(0.2, 0, 0, 1),
              transform 800ms cubic-bezier(0.2, 0, 0, 1);
}

[data-animate].is-visible {
  opacity: 1;
  transform: translateY(0);
}

// Stagger container — children reveal in sequence
[data-stagger].is-visible > [data-animate] {
  opacity: 1;
  transform: translateY(0);
}

[data-stagger].is-visible > [data-animate]:nth-child(1) { transition-delay: 0ms; }
[data-stagger].is-visible > [data-animate]:nth-child(2) { transition-delay: 150ms; }
[data-stagger].is-visible > [data-animate]:nth-child(3) { transition-delay: 300ms; }
[data-stagger].is-visible > [data-animate]:nth-child(4) { transition-delay: 450ms; }
[data-stagger].is-visible > [data-animate]:nth-child(5) { transition-delay: 600ms; }
[data-stagger].is-visible > [data-animate]:nth-child(6) { transition-delay: 750ms; }

// Pipeline arrows — horizontal nudge, override stagger delay
.pipeline-arrow[data-animate] {
  transform: translateX(4px);
  transition-duration: 400ms;
}

[data-stagger].is-visible > .pipeline-arrow[data-animate],
.pipeline-arrow[data-animate].is-visible {
  transform: translateX(0);
  transition-delay: 300ms;
}

@media (max-width: $bp-tablet) {
  .pipeline-arrow[data-animate] {
    transform: rotate(90deg) translateX(4px);
  }

  [data-stagger].is-visible > .pipeline-arrow[data-animate],
  .pipeline-arrow[data-animate].is-visible {
    transform: rotate(90deg) translateX(0);
  }
}

// Section header — subtitle staggers behind heading
.section-header[data-animate] p {
  opacity: 0;
  transform: translateY(8px);
  transition: opacity 400ms cubic-bezier(0.22, 1, 0.36, 1),
              transform 400ms cubic-bezier(0.22, 1, 0.36, 1);
  transition-delay: 80ms;
}

.section-header[data-animate].is-visible p {
  opacity: 1;
  transform: translateY(0);
}

// ── Ambient backgrounds ───────────────────────────────────────
// Content sits above effect overlays so text stays crisp
#site-nav,
main,
.footer {
  position: relative;
  z-index: 2;
}

// CRT effect — scanlines + sweeping refresh beam
body::before {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 1;
  background-image:
    // Refresh beam — faint bright band that sweeps top-to-bottom
    linear-gradient(
      transparent,
      rgba(255, 255, 255, 0.03) 50%,
      transparent
    ),
    // Scanline stripe pattern — 3px period, 1px dark line
    repeating-linear-gradient(
      to bottom,
      transparent,
      transparent 2px,
      rgba(0, 0, 0, 0.2) 2px,
      rgba(0, 0, 0, 0.2) 3px
    );
  background-size: 100% 8vh, auto;
  background-repeat: no-repeat, repeat;
  animation: crt-beam 6s linear infinite;

  @media (prefers-reduced-motion: reduce) {
    animation: none;
    background-image: repeating-linear-gradient(
      to bottom,
      transparent,
      transparent 2px,
      rgba(0, 0, 0, 0.2) 2px,
      rgba(0, 0, 0, 0.2) 3px
    );
    background-size: auto;
  }
}

@keyframes crt-beam {
  0%   { background-position: 0 -8vh, 0 0; }
  100% { background-position: 0 108vh, 0 0; }
}

// Chromatic aberration — RGB fringing at screen edges
// Simulates CRT convergence degradation: color channels misalign
// toward the periphery, center stays clean
html::after {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 1;
  background:
    // Red bleed — top-left corner
    radial-gradient(ellipse at 0% 0%, rgba(255, 20, 20, 0.08), transparent 50%),
    // Cyan bleed — bottom-right corner (complementary to red)
    radial-gradient(ellipse at 100% 100%, rgba(0, 200, 255, 0.08), transparent 50%),
    // Blue fringe — bottom-left corner
    radial-gradient(ellipse at 0% 100%, rgba(60, 60, 255, 0.05), transparent 40%),
    // Red fringe — top-right corner
    radial-gradient(ellipse at 100% 0%, rgba(255, 40, 40, 0.05), transparent 40%);
}

// Film grain — subtle organic texture across all pages
// Uses SVG feTurbulence with stitchTiles for seamless 256px tiling
body::after {
  content: "";
  position: fixed;
  inset: 0;
  opacity: 0.05;
  pointer-events: none;
  z-index: 1;
  background: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  background-size: 256px 256px;
}

// Home page — gradient mesh atmosphere
.page-home {
  background:
    // Warm pink glow — upper right, simulates off-screen ambient light
    radial-gradient(ellipse 80% 50% at 80% -5%, rgba($primary, 0.09), transparent 70%),
    // Gold warmth — lower left, complementary accent
    radial-gradient(ellipse 50% 60% at 10% 95%, rgba($tertiary, 0.06), transparent 55%),
    // Center spotlight — subtle focus pull toward hero content
    radial-gradient(circle at 50% 40%, rgba($primary, 0.04), transparent 45%),
    // Vignette — darkened edges add depth and frame the content
    radial-gradient(ellipse 70% 70% at 50% 50%, transparent 55%, rgba(0, 0, 0, 0.35)),
    // Base
    $surface-lowest;
  background-attachment: fixed;

  @media (max-width: $bp-mobile) {
    background-attachment: scroll;
  }
}

// ── Navigation ─────────────────────────────────────────────
#site-nav {
  position: sticky;
  top: 1.5rem;
  z-index: 999;
  margin: 0 auto;
  width: max-content;
  max-width: min(100% - 2rem, 1000px);

  nav {
    view-transition-name: site-nav;
    position: relative;
    user-select: none;
    // Surface gradient — curved glass refracts more light at the top
    background: linear-gradient(
      180deg,
      rgba($surface-container, 0.62),
      rgba($surface-container, 0.48)
    );
    // Refraction: blur + subtle brightness/saturation boost
    backdrop-filter: blur(20px) brightness(1.1) saturate(1.15);
    -webkit-backdrop-filter: blur(20px) brightness(1.1) saturate(1.15);
    // Top border catches more light than the sides
    border: 1px solid rgba($text-outline-variant, 0.35);
    border-top-color: rgba($text-primary, 0.1);
    border-radius: 999px;
    padding: 5px 7px 5px 5px;
    // Layered: outer depth, soft spread, inner top highlight, inner bottom shadow
    box-shadow:
      0 4px 24px rgba(0, 0, 0, 0.15),
      0 1px 3px rgba(0, 0, 0, 0.08),
      inset 0 1px 0 rgba(255, 255, 255, 0.07),
      inset 0 -1px 0 rgba(0, 0, 0, 0.08);
    display: flex;
    align-items: center;
    gap: 2px;
    transition: background 0.3s ease-out,
                box-shadow 0.3s ease-out,
                border-radius 0.3s ease-out,
                border-color 0.3s ease-out;

    // Specular highlight — light concentrates at the apex of convex glass
    &::before {
      content: "";
      position: absolute;
      top: 0;
      left: 15%;
      right: 15%;
      height: 1px;
      background: radial-gradient(
        ellipse at 50% 0%,
        rgba(255, 255, 255, 0.22),
        rgba(255, 255, 255, 0.06) 55%,
        transparent
      );
      pointer-events: none;
    }
  }

  // Solidify on scroll — glass becomes denser, specular sharpens
  &.scrolled nav {
    background: linear-gradient(
      180deg,
      rgba($surface-container, 0.92),
      rgba($surface-container, 0.84)
    );
    backdrop-filter: blur(24px) brightness(1.05) saturate(1.1);
    -webkit-backdrop-filter: blur(24px) brightness(1.05) saturate(1.1);
    box-shadow:
      0 8px 32px rgba(0, 0, 0, 0.3),
      0 2px 6px rgba(0, 0, 0, 0.12),
      inset 0 1px 0 rgba(255, 255, 255, 0.09),
      inset 0 -1px 0 rgba(0, 0, 0, 0.1);
    border-color: rgba($text-outline-variant, 0.55);
    border-top-color: rgba($text-primary, 0.12);
  }

  // ── Shared link styles ──
  a {
    display: flex;
    align-items: center;
    padding: 8px 14px;
    border-radius: 999px;
    font-size: $text-sm;
    font-weight: 600;
    color: $text-secondary;
    text-decoration: none;
    line-height: 1;
    white-space: nowrap;
    transition: color 0.15s ease,
                background-color 0.15s ease;

    &:hover {
      background-color: rgba($text-primary, 0.06);
      color: $text-primary;
    }

    &.active {
      color: $primary;
      background-color: rgba($primary, 0.08);
    }
  }

  // ── Logo ──
  .nav-logo {
    gap: 8px;
    color: $text-primary;
    font-weight: 800;
    padding: 8px 14px;

    img {
      filter: drop-shadow(0 0 4px rgba($primary, 0.3));
    }
  }

  // ── Middle links (desktop) ──
  .nav-links {
    display: flex;
    align-items: center;
    gap: 2px;
    margin-left: 2px;

    // Subtle left separator
    &::before {
      content: "";
      width: 1px;
      height: 16px;
      background-color: rgba($text-outline-variant, 0.7);
      margin-right: 4px;
    }
  }

  // ── Right-side actions ──
  .nav-end {
    display: flex;
    align-items: center;
    gap: 2px;
    margin-left: auto;
    padding-left: 2px;

    // Subtle left separator
    &::before {
      content: "";
      width: 1px;
      height: 16px;
      background-color: rgba($text-outline-variant, 0.7);
      margin-right: 4px;
    }
  }

  .nav-icon {
    padding: 8px;
    color: $text-outline;

    &:hover {
      color: $text-primary;
      background-color: rgba($text-primary, 0.06);
    }
  }

  // ── Language dropdown ──
  .nav-lang-dropdown {
    position: relative;
  }

  .nav-lang-trigger {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 6px 10px;
    border: none;
    background: none;
    border-radius: 999px;
    font-family: inherit;
    font-size: $text-xs;
    font-weight: 700;
    color: $text-outline;
    letter-spacing: 0.04em;
    cursor: pointer;
    line-height: 1;
    white-space: nowrap;
    transition: color 0.15s ease,
                background-color 0.15s ease;

    &:hover {
      color: $text-primary;
      background-color: rgba($text-primary, 0.06);
    }
  }

  .nav-lang-chevron {
    transition: transform 0.2s cubic-bezier(0.22, 1, 0.36, 1);
  }

  .nav-lang-dropdown.open .nav-lang-chevron {
    transform: rotate(180deg);
  }

  .nav-lang-menu {
    position: absolute;
    top: calc(100% + 8px);
    right: 0;
    min-width: 140px;
    padding: 4px;
    border-radius: $radius-lg;
    corner-shape: squircle;
    // Nested inside nav's backdrop-filter — child blur can't see
    // through the parent's backdrop root, so use near-opaque fill.
    background: linear-gradient(
      180deg,
      rgba($surface-high, 0.97),
      rgba($surface-container, 0.95)
    );
    border: 1px solid rgba($text-outline-variant, 0.5);
    box-shadow:
      0 8px 24px rgba(0, 0, 0, 0.25),
      0 2px 6px rgba(0, 0, 0, 0.1);

    // Hidden by default
    opacity: 0;
    visibility: hidden;
    transform: translateY(-4px) scale(0.96);
    transform-origin: top right;
    transition: opacity 0.12s ease-out,
                visibility 0.12s ease-out,
                transform 0.12s ease-out;

    a {
      display: block;
      padding: 8px 12px;
      font-size: $text-sm;
      font-weight: 500;
      color: $text-secondary;
      border-radius: $radius-md;
      corner-shape: squircle;

      &:hover {
        background-color: rgba($text-primary, 0.06);
        color: $text-primary;
      }

      &.active {
        color: $primary;
        background-color: rgba($primary, 0.08);
        font-weight: 600;
      }
    }
  }

  .nav-lang-dropdown.open .nav-lang-menu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0) scale(1);
    transition: opacity 0.15s cubic-bezier(0.22, 1, 0.36, 1),
                visibility 0.15s cubic-bezier(0.22, 1, 0.36, 1),
                transform 0.2s cubic-bezier(0.22, 1, 0.36, 1);
  }

  .nav-lang-mobile {
    color: $primary-dim;
    font-weight: 600;
  }

  .nav-cta {
    background-color: rgba($primary, 0.1);
    color: $primary;
    font-weight: 700;
    padding: 8px 16px;
    margin-left: 2px;
    transition: background-color 0.15s ease-out,
                color 0.15s ease-out,
                box-shadow 0.15s ease-out;

    &:hover {
      background-color: $primary;
      color: $on-primary;
      box-shadow: 0 2px 12px rgba($primary, 0.3);
    }
  }

  // ── Hamburger toggle (mobile only) ──
  .nav-toggle {
    display: none;
    justify-content: center;
    align-items: center;
    width: 32px;
    height: 32px;
    padding: 0;
    border: none;
    background: none;
    cursor: pointer;
    border-radius: 999px;
    color: $text-secondary;
    transition: background-color 0.15s ease, color 0.15s ease;

    &:hover {
      background-color: rgba($text-primary, 0.06);
      color: $text-primary;
    }
  }

  // Animated hamburger → X
  // Origin-aware: all lines rotate around SVG center (12,12).
  // Top/bottom translateY to center, then rotate ±45° to form X.
  .nav-toggle-icon {
    .line-top, .line-mid, .line-bot {
      transform-origin: 12px 12px;
      // Close animation: gentle settle
      transition: transform 300ms cubic-bezier(0.16, 1, 0.3, 1),
                  opacity 150ms cubic-bezier(0.16, 1, 0.3, 1);
    }
  }

  &.open .nav-toggle-icon {
    .line-top {
      transform: rotate(45deg) translateY(7px);
    }

    .line-mid {
      opacity: 0;
    }

    .line-bot {
      transform: rotate(-45deg) translateY(-7px);
    }

    .line-top, .line-mid, .line-bot {
      // Open animation: snappy response
      transition: transform 200ms cubic-bezier(0.16, 1, 0.3, 1),
                  opacity 100ms cubic-bezier(0.16, 1, 0.3, 1);
    }
  }

  // ── Mobile drawer (hidden on desktop) ──
  .nav-drawer {
    display: none;
  }

  // ── Responsive ──
  @media (max-width: $bp-mobile) {
    top: 1rem;
    max-width: calc(100% - 1.5rem);
    width: auto;

    nav {
      flex-wrap: wrap;
      border-radius: $radius-xl;
      corner-shape: squircle;
    }

    a {
      padding: 7px 12px;
      font-size: $text-xs;
    }

    .nav-logo {
      padding: 7px 12px;

      span { display: none; }
    }

    .nav-links { display: none; }
    .nav-icon { display: none; }
    .nav-lang-dropdown { display: none; }
    .nav-toggle { display: flex; }

    .nav-end::before { display: none; }

    .nav-drawer {
      display: grid;
      grid-template-rows: 0fr;
      width: 100%;
      border-top: 1px solid transparent;
      transition: grid-template-rows 0.15s cubic-bezier(0.32, 0.72, 0, 1),
                  border-color 0.15s ease-out;
    }

    .nav-drawer-inner {
      overflow: hidden;
      display: flex;
      flex-direction: column;
      padding-inline: 4px;

      a {
        padding: 10px 14px;
        font-size: $text-sm;
        border-radius: $radius-md;
        corner-shape: squircle;
        justify-content: flex-start;
        gap: 8px;

        opacity: 0;
        transform: translateY(-8px) scale(0.96);
        transition: opacity 0.1s ease-in,
                    transform 0.1s ease-in,
                    color 0.15s ease-out,
                    background-color 0.15s ease-out;
      }
    }

    &.open {
      .nav-drawer {
        grid-template-rows: 1fr;
        margin-top: 4px;
        padding-block: 4px 2px;
        border-color: rgba($text-outline-variant, 0.4);
        transition: grid-template-rows 0.25s cubic-bezier(0.32, 0.72, 0, 1),
                    border-color 0.2s ease-out;
      }

      .nav-drawer-inner a {
        opacity: 1;
        transform: translateY(0) scale(1);
        transition: opacity 0.2s cubic-bezier(0.22, 1, 0.36, 1),
                    transform 0.25s cubic-bezier(0.22, 1, 0.36, 1),
                    color 0.15s ease-out,
                    background-color 0.15s ease-out;

        &:nth-child(1) { transition-delay: 0.03s; }
        &:nth-child(2) { transition-delay: 0.06s; }
        &:nth-child(3) { transition-delay: 0.09s; }
        &:nth-child(4) { transition-delay: 0.12s; }
      }
    }
  }
}

// ── Home (full-height landing) ────────────────────────────────
.page-home {
  min-height: 100vh;
  min-height: 100dvh;
}

.page-home main {
  display: flex;
  flex-direction: column;
  min-height: calc(100vh - 80px);
  min-height: calc(100dvh - 80px);
  position: relative;
  clip-path: inset(0);

  // Subtle grid — flat, radially faded, sits behind hero content
  &::before {
    content: "";
    position: absolute;
    inset: -10%;
    z-index: 0;
    background-image:
      linear-gradient(rgba($text-outline-variant, 0.15) 1px, transparent 1px),
      linear-gradient(90deg, rgba($text-outline-variant, 0.15) 1px, transparent 1px);
    background-size: 48px 48px;
    mask-image: radial-gradient(ellipse 65% 65% at 50% 45%, black 15%, transparent 75%);
    pointer-events: none;
  }
}

.home-center {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding-inline: $container-padding;
  position: relative;
  z-index: 1;
}

.home-logo {
  margin-bottom: $space-2xl;
  filter: drop-shadow(0 0 24px rgba($primary, 0.2));

  @media (max-width: $bp-mobile) {
    width: 72px;
    height: 72px;
    margin-bottom: $space-xl;
  }
}

.home-badge {
  display: inline-flex;
  align-items: center;
  gap: $space-sm;
  padding: $space-xs $space-lg;
  border-radius: 9999px;
  background-color: rgba($primary, 0.08);
  border: 1px solid rgba($primary, 0.15);
  color: $primary;
  font-size: $text-sm;
  font-weight: 500;
  user-select: none;
  white-space: nowrap;
  margin-bottom: $space-2xl;

  @media (max-width: $bp-mobile) {
    font-size: $text-xs;
    margin-bottom: $space-lg;
  }
}

.home-headline {
  font-size: clamp(#{$text-2xl}, 5vw + 1rem, #{$text-hero});
  font-weight: 400;
  font-family: $font-pixel;
  line-height: $lh-tight;
  letter-spacing: -0.02em;
  margin-bottom: $space-xl;
  color: $text-primary;

  @media (max-width: $bp-mobile) {
    margin-bottom: $space-lg;
  }
}

.home-tagline {
  font-size: $text-lg;
  color: $text-secondary;
  line-height: $lh-loose;
  max-width: 540px;
  margin-bottom: $space-3xl;

  @media (max-width: $bp-mobile) {
    font-size: $text-base;
    margin-bottom: $space-xl;
  }
}

.home-ctas {
  display: flex;
  align-items: center;
  gap: $space-lg;
  flex-wrap: wrap;
  justify-content: center;

  @media (max-width: $bp-mobile) {
    flex-direction: column;
    width: 100%;

    .btn {
      width: 100%;
      justify-content: center;
    }
  }
}

.home-bottom {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: $space-xl;
  padding: $space-xl $container-padding;
  border-top: 1px solid $text-outline-variant;
  position: relative;
  z-index: 1;
  user-select: none;

  @media (max-width: $bp-mobile) {
    flex-direction: column;
    gap: $space-md;
    padding: $space-lg $container-padding;
  }
}

.home-bottom-label {
  font-size: $text-xs;
  color: $text-outline;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-weight: 600;
}

.home-services {
  display: flex;
  align-items: center;
  gap: $space-sm;
  font-size: $text-sm;
  color: $text-secondary;
  font-weight: 500;
  white-space: nowrap;
}

.home-dot {
  color: $text-outline-variant;
}

.home-platforms {
  display: flex;
  align-items: center;
  gap: $space-sm;
  opacity: 0.5;
}

// ── Hero entrance (page-load stagger) ─────────────────────────
@keyframes hero-enter {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes hero-enter-subtle {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.page-home .home-logo,
.page-home .home-badge,
.page-home .home-headline,
.page-home .home-tagline,
.page-home .home-ctas {
  opacity: 0;
  animation: hero-enter 600ms cubic-bezier(0.22, 1, 0.36, 1) forwards;
}

.page-home .home-logo     { animation-delay: 0ms; }
.page-home .home-badge    { animation-delay: 80ms; }
.page-home .home-headline { animation-delay: 140ms; }
.page-home .home-tagline  { animation-delay: 200ms; }
.page-home .home-ctas     { animation-delay: 280ms; }

.page-home .home-bottom {
  opacity: 0;
  animation: hero-enter-subtle 500ms cubic-bezier(0.22, 1, 0.36, 1) 380ms forwards;
}

// Short-viewport overrides — landscape phones, split-screen, etc.
@media (max-height: 640px) {
  .home-logo       { width: 56px; height: 56px; margin-bottom: 16px; }
  .home-badge      { margin-bottom: 12px; }
  .home-headline   { font-size: $text-2xl; margin-bottom: 12px; }
  .home-tagline    { font-size: $text-sm; margin-bottom: 16px; }
  .home-bottom     { padding: 12px; }
}

// ── Overview page spacer ──────────────────────────────────────
.overview-spacer {
  height: 96px;

  @media (max-width: $bp-tablet) {
    height: 72px;
  }
}

// ── Features ───────────────────────────────────────────────
.features {
  background-color: $surface-base;
}

// ── How It Works (Pipeline) ──────────────────────────────────
.how-it-works {
  background-color: $surface-lowest;
}

.pipeline {
  display: flex;
  align-items: flex-start;
  justify-content: center;
  gap: $space-xl;

  @media (max-width: $bp-tablet) {
    flex-direction: column;
    align-items: center;
    gap: $space-2xl;
  }
}

.pipeline-step {
  flex: 1;
  max-width: 340px;
  text-align: center;

  // Subtitle sits between heading and description
  .pipeline-subtitle {
    margin-bottom: $space-sm;
  }

  @media (max-width: $bp-tablet) {
    max-width: 480px;
    width: 100%;
  }
}

// Adds badge-positioning context on top of .card-icon base
.pipeline-icon {
  position: relative;
}

.pipeline-label {
  position: absolute;
  top: -4px;
  right: -4px;
  width: 22px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  background-color: $primary;
  color: $on-primary;
  font-size: $text-xs;
  font-weight: 700;
  line-height: 1;
  user-select: none;
}

.card .pipeline-subtitle {
  font-size: $text-sm;
  color: $primary-dim;
  font-weight: 500;
}

.pipeline-arrow {
  display: flex;
  align-items: center;
  color: $text-outline;
  user-select: none;
  margin-top: 72px; // vertically center with the icon area
  @media (max-width: $bp-tablet) {
    margin-top: 0;
    transform: rotate(90deg);
  }
}

// ── Parser Demo ───────────────────────────────────────
.parser-demo {
  background-color: $surface-lowest;
  position: relative;
  overflow: hidden;
  z-index: 0;
  clip-path: inset(0);

  // Ambient glows
  &::before {
    content: "";
    position: fixed;
    inset: 0;
    z-index: -1;
    background:
      radial-gradient(circle at 15% 25%, rgba($primary, 0.05) 0%, transparent 40%),
      radial-gradient(circle at 85% 75%, rgba($tertiary, 0.03) 0%, transparent 40%),
      radial-gradient(circle at 50% 50%, rgba($primary-container, 0.02) 0%, transparent 60%);
    pointer-events: none;
  }

  // Perspective grid
  &::after {
    content: "";
    position: fixed;
    inset: -50%;
    z-index: -1;
    background-image:
      linear-gradient(rgba($text-outline-variant, 0.12) 1.5px, transparent 1.5px),
      linear-gradient(90deg, rgba($text-outline-variant, 0.12) 1.5px, transparent 1.5px);
    background-size: 64px 64px;
    mask-image: radial-gradient(ellipse at center, black 20%, transparent 80%);
    transform: perspective(800px) rotateX(25deg);
    pointer-events: none;
  }
}

  

  .demo-widget {
  max-width: 720px;
  margin-inline: auto;
  position: relative;

  &::before {
    content: "";
    position: absolute;
    inset: -40px;
    background: radial-gradient(circle at center, rgba($primary, 0.04), transparent 70%);
    z-index: -1;
    pointer-events: none;
  }
}

.demo-input-area {
  margin-bottom: $space-lg;
}

.demo-input-wrapper {
  position: relative;
  background-color: $surface-container;
  border: 1px solid $text-outline-variant;
  border-radius: $radius-lg;
  corner-shape: squircle;
  overflow: hidden;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;

  &:focus-within {
    border-color: rgba($primary, 0.6);
    box-shadow: 0 0 0 3px rgba($primary, 0.15);
  }
}

.demo-input-highlight {
  position: absolute;
  inset: 0;
  padding: $space-lg calc(#{$space-lg} + 26px) $space-lg $space-lg;
  color: $text-outline;
  font-family: $font-mono;
  font-size: $text-sm;
  font-weight: 600;
  line-height: 1.45;
  white-space: pre;
  overflow-x: auto;
  overflow-y: hidden;
  pointer-events: none;
  user-select: none;
  scrollbar-width: none;

  &::-webkit-scrollbar {
    display: none;
  }
}

.demo-input-editable {
  position: absolute;
  top: 50%;
  right: $space-md;
  width: 16px;
  height: 16px;
  transform: translateY(-50%);
  color: $text-outline;
  pointer-events: none;
  z-index: 2;
  transition: color 0.2s ease;

  svg {
    width: 100%;
    height: 100%;
  }
}

.demo-input-wrapper:focus-within .demo-input-editable {
  color: $primary-dim;
}

.demo-input {
  position: relative;
  z-index: 1;
  width: 100%;
  padding: $space-lg calc(#{$space-lg} + 26px) $space-lg $space-lg;
  background-color: transparent;
  border: 0;
  color: $text-primary;
  font-family: $font-mono;
  font-size: $text-sm;
  font-weight: 600;
  line-height: 1.45;
  outline: none;

  &::placeholder {
    color: $text-outline;
  }

  &.highlighted {
    color: transparent;
    caret-color: $text-primary;
    -webkit-text-fill-color: transparent;
  }
}

.demo-examples {
  display: flex;
  align-items: center;
  gap: $space-sm;
  flex-wrap: wrap;
  margin-bottom: $space-xl;
}

.demo-examples-label {
  font-size: $text-xs;
  font-weight: 600;
  color: $text-outline;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  user-select: none;
}

.demo-example-btn {
  padding: $space-xxs $space-md;
  border: 1px solid $text-outline-variant;
  border-radius: 999px;
  background: none;
  color: $text-secondary;
  font-family: inherit;
  font-size: $text-xs;
  font-weight: 500;
  cursor: pointer;
  user-select: none;
  transition: border-color 0.15s ease, color 0.15s ease, background-color 0.15s ease;

  &:hover {
    border-color: rgba($primary, 0.5);
    color: $primary;
    background-color: rgba($primary, 0.06);
  }
}

.demo-output {
  background-color: $surface-container;
  border: 1px solid $text-outline-variant;
  border-radius: $radius-lg;
  corner-shape: squircle;
  padding: $space-xl;
  min-height: 120px;
}

.demo-empty {
  color: $text-outline;
  font-size: $text-sm;
  text-align: center;
  margin: 0;
}

.demo-loading {
  color: $text-outline;
  font-size: $text-sm;
  text-align: center;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: $space-sm;

  &::before {
    content: "";
    width: 14px;
    height: 14px;
    border: 2px solid $text-outline-variant;
    border-top-color: $primary;
    border-radius: 50%;
    animation: demo-spin 0.6s linear infinite;
  }
}

@keyframes demo-spin {
  to { transform: rotate(360deg); }
}

// Category accent colors
$demo-cat-title:   $primary-dim;    // pink  — title, type, year
$demo-cat-episode: $tertiary;       // gold  — episode, season, part, volume
$demo-cat-video:   $success;        // green — resolution, video codec, video terms
$demo-cat-audio:   #C4A8FF;         // lavender — audio codec, audio terms
$demo-cat-release: #7DD3E8;         // cyan  — group, source, version, release info
$demo-cat-file:    $text-outline;   // muted — checksum, extension, language, subs

.demo-hl-title   { color: $demo-cat-title; }
.demo-hl-episode { color: $demo-cat-episode; }
.demo-hl-video   { color: $demo-cat-video; }
.demo-hl-audio   { color: $demo-cat-audio; }
.demo-hl-release { color: $demo-cat-release; }
.demo-hl-file    { color: $demo-cat-file; }

.demo-field {
  display: flex;
  align-items: baseline;
  gap: $space-md;
  padding: $space-xs $space-md;
  border-left: 2px solid transparent;

  &:not(:last-child) {
    border-bottom: 1px solid rgba($text-outline-variant, 0.4);
  }
}

.demo-cat-title   { border-left-color: $demo-cat-title; }
.demo-cat-episode { border-left-color: $demo-cat-episode; }
.demo-cat-video   { border-left-color: $demo-cat-video; }
.demo-cat-audio   { border-left-color: $demo-cat-audio; }
.demo-cat-release { border-left-color: $demo-cat-release; }
.demo-cat-file    { border-left-color: $demo-cat-file; }

.demo-key {
  flex-shrink: 0;
  width: 160px;
  font-size: $text-xs;
  font-weight: 600;

  .demo-cat-title &   { color: $demo-cat-title; }
  .demo-cat-episode & { color: $demo-cat-episode; }
  .demo-cat-video &   { color: $demo-cat-video; }
  .demo-cat-audio &   { color: $demo-cat-audio; }
  .demo-cat-release & { color: $demo-cat-release; }
  .demo-cat-file &    { color: $demo-cat-file; }

  @media (max-width: $bp-mobile) {
    width: 120px;
  }
}

.demo-value {
  font-family: $font-mono;
  font-size: $text-sm;
  color: $text-primary;
  word-break: break-word;
}

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

// ── Supported ────────────────────────────────────────────────
.supported {
  background-color: $surface-base;
  overflow: hidden;
}

.supported-marquee {
  display: flex;
  flex-direction: column;
  gap: $space-sm;
  -webkit-mask-image: linear-gradient(to right, transparent 0%, black 10%, black 90%, transparent 100%);
  mask-image: linear-gradient(to right, transparent 0%, black 10%, black 90%, transparent 100%);
}

.supported-marquee__row {
  display: flex;
  width: max-content;
}

.supported-marquee__track {
  display: flex;
  gap: $space-md;
  padding-right: $space-md;
  flex-shrink: 0;

  .logo-grid-item {
    flex-shrink: 0;
    font-size: $text-xs;
    padding: $space-xs $space-sm;
  }
}

// Pill entrance — staggered slide-up per row
.supported-marquee .logo-grid-item {
  opacity: 0;
  transform: translateY(12px);
  transition: opacity 400ms cubic-bezier(0.22, 1, 0.36, 1),
              transform 400ms cubic-bezier(0.22, 1, 0.36, 1);
}

.supported-marquee.is-visible .logo-grid-item {
  opacity: 1;
  transform: translateY(0);
}

@for $i from 1 through 11 {
  .supported-marquee.is-visible .logo-grid-item:nth-child(#{$i}) {
    transition-delay: #{($i - 1) * 40}ms;
  }
}

@media (prefers-reduced-motion: reduce) {
  .supported-marquee .logo-grid-item {
    opacity: 1;
    transform: none;
    transition: none;
  }
}

// ── FAQ ───────────────────────────────────────────────────
.faq {
  background-color: $surface-lowest;
}

.faq-list {
  max-width: 720px;
  margin-inline: auto;
  display: flex;
  flex-direction: column;
  gap: $space-md;
}

.faq-item {
  background-color: $surface-container;
  border: 1px solid $text-outline-variant;
  border-radius: $radius-lg;
  corner-shape: squircle;
  transition: border-color 0.2s ease;

  &[open] {
    border-color: rgba($primary, 0.4);

    .faq-chevron {
      transform: rotate(180deg);
    }
  }

  summary {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: $space-md;
    padding: $space-xl;
    cursor: pointer;
    font-weight: 600;
    font-size: $text-base;
    color: $text-primary;
    list-style: none;
    user-select: none;

    &::-webkit-details-marker {
      display: none;
    }

    &::marker {
      display: none;
      content: "";
    }

    &:hover {
      color: $primary;
    }

    @media (max-width: $bp-mobile) {
      padding: $space-lg;
      font-size: $text-sm;
    }
  }

  .faq-chevron {
    flex-shrink: 0;
    color: $text-outline;
    transition: transform 0.2s cubic-bezier(0.22, 1, 0.36, 1);
  }
}

.faq-item[open] > .faq-answer {
  animation: faq-reveal 300ms cubic-bezier(0.22, 1, 0.36, 1);
}

@keyframes faq-reveal {
  from {
    opacity: 0;
    transform: translateY(-4px);
  }
}

// Smooth expand/collapse in browsers supporting interpolate-size
@supports (interpolate-size: allow-keywords) {
  .faq-item {
    interpolate-size: allow-keywords;
  }

  .faq-item::details-content {
    overflow: hidden;
    height: 0;
    opacity: 0;
    transition: height 300ms cubic-bezier(0.22, 1, 0.36, 1),
                opacity 300ms cubic-bezier(0.22, 1, 0.36, 1),
                content-visibility 300ms allow-discrete;
  }

  .faq-item[open]::details-content {
    height: auto;
    opacity: 1;
  }

  @starting-style {
    .faq-item[open]::details-content {
      height: 0;
      opacity: 0;
    }
  }

  // Disable keyframe fallback — ::details-content handles opacity
  .faq-item[open] > .faq-answer {
    animation: none;
  }
}

.faq-answer {
  padding: 0 $space-xl $space-xl;

  p {
    font-size: $text-sm;
    color: $text-secondary;
    line-height: $lh-loose;
  }

  code {
    font-size: $text-xs;
    color: $primary-dim;
    background-color: $surface-high;
    padding: $space-xxs $space-xs;
    border-radius: $radius-sm;
  }

  @media (max-width: $bp-mobile) {
    padding: 0 $space-lg $space-lg;
  }
}

// ── Download ───────────────────────────────────────────────
.download {
  background-color: $surface-base;
}

.download-card {
  background-color: $surface-container;
  border: 1px solid $primary-container;
  border-radius: $radius-xl;
  corner-shape: squircle;
  padding: $space-3xl;
  text-align: center;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);

  @media (max-width: $bp-mobile) {
    padding: $space-xl;
  }
}

.download-platforms {
  display: flex;
  justify-content: center;
  gap: $space-2xl;
  margin-bottom: $space-3xl;

  @media (max-width: $bp-tablet) {
    flex-direction: column;
    align-items: center;
    gap: $space-lg;
  }
}

.platform-item {
  display: flex;
  flex-direction: column;
  gap: $space-sm;

  @media (max-width: $bp-mobile) {
    width: 100%;
    align-items: center;

    .btn {
      width: 100%;
      justify-content: center;
    }
  }
}

.platform-info {
  font-size: $text-xs;
  color: $text-outline;
}

.platform-note {
  font-size: $text-xs;
  color: $text-outline;
  margin-top: $space-xxs;

  code {
    font-size: $text-xs;
    color: $primary-dim;
    background-color: $surface-high;
    padding: 1px $space-xxs;
    border-radius: $radius-sm;
  }
}

.btn-lg {
  padding: $space-lg $space-2xl;
  font-size: $text-lg;

  @media (max-width: $bp-mobile) {
    padding: $space-md $space-xl;
    font-size: $text-base;
  }
}

.download-features {
  margin-bottom: $space-2xl;

  .download-features-label {
    font-size: $text-xs;
    color: $text-outline;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    font-weight: 600;
    user-select: none;
    margin-bottom: $space-md;
  }

  ul {
    list-style: none;
    padding: 0;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: $space-sm $space-xl;

    @media (max-width: $bp-mobile) {
      flex-direction: column;
      align-items: center;
      gap: $space-sm;
    }
  }

  li {
    font-size: $text-sm;
    color: $text-secondary;
    position: relative;
    padding-left: $space-lg;

    &::before {
      content: "✓";
      position: absolute;
      left: 0;
      color: $success;
      font-weight: 600;
    }
  }
}

.download-source {
  border-top: 1px solid $text-outline-variant;
  padding-top: $space-2xl;

  p {
    font-size: $text-sm;
    color: $text-outline;
    margin-bottom: $space-md;
  }

  .code-block {
    @media (max-width: $bp-mobile) {
      font-size: $text-xs;
      padding: $space-md $space-lg;
    }
  }
}

// ── Footer ─────────────────────────────────────────────────
.footer {
  border-top: 1px solid $text-outline-variant;
  padding-block: $space-3xl;
  background-color: $surface-lowest;

  @media (max-width: $bp-mobile) {
    padding-block: $space-2xl;
  }
}

.footer-grid {
  display: grid;
  grid-template-columns: 1.5fr 1fr 1fr;
  gap: $space-3xl;

  @media (max-width: $bp-tablet) {
    grid-template-columns: 1fr 1fr;
    gap: $space-2xl;
  }

  @media (max-width: $bp-mobile) {
    grid-template-columns: 1fr;
    gap: $space-xl;
    text-align: center;
  }
}

.footer-brand {
  display: flex;
  align-items: center;
  gap: $space-sm;
  color: $text-primary;
  font-weight: 600;
  font-size: $text-base;
  user-select: none;
  margin-bottom: $space-sm;

  @media (max-width: $bp-mobile) {
    justify-content: center;
  }
}

.footer-about p {
  font-size: $text-sm;
  color: $text-outline;
  line-height: $lh-loose;
}

.footer-column {
  display: flex;
  flex-direction: column;
  gap: $space-sm;

  a {
    font-size: $text-sm;
    color: $text-outline;
    text-decoration: none;
    position: relative;
    width: fit-content;
    transition: color 0.15s ease;

    &::after {
      content: "";
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 100%;
      height: 1px;
      background-color: $primary-dim;
      transform: scaleX(0);
      transform-origin: right;
      transition: transform 0.2s cubic-bezier(0.22, 1, 0.36, 1);
    }

    &:hover {
      color: $text-primary;

      &::after {
        transform: scaleX(1);
        transform-origin: left;
      }
    }

    @media (max-width: $bp-mobile) {
      margin-inline: auto;
    }
  }
}

.footer-column-title {
  font-size: $text-xs;
  color: $text-secondary;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-weight: 600;
  user-select: none;
  margin-bottom: $space-xs;
}
